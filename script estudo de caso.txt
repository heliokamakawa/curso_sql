DROP DATABASE IF EXISTS BANCO;
CREATE DATABASE BANCO;

USE BANCO;

CREATE TABLE estado( 
id INT NOT NULL AUTO_INCREMENT
,nome VARCHAR(200) NOT NULL UNIQUE  
,sigla CHAR(2) NOT NULL UNIQUE
,ativo ENUM('S','N') NOT NULL DEFAULT 'S'
,data_cadastro DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP
,CONSTRAINT pk_estado PRIMARY KEY (id)  
);

CREATE TABLE cidade (
id INT NOT NULL AUTO_INCREMENT
,nome VARCHAR(200)  NOT NULL
,ativo ENUM('S','N') NOT NULL DEFAULT 'S'
,data_cadastro DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP
,estado_id INT NOT NULL 
,CONSTRAINT pk_cidade PRIMARY KEY (id)
,CONSTRAINT fk_cidade_estado FOREIGN KEY (estado_id) REFERENCES estado (id)
,CONSTRAINT cidade_unica UNIQUE(nome, estado_id)
);

CREATE TABLE FUNCIONARIO(
ID INT AUTO_INCREMENT 
,NOME VARCHAR(255) NOT NULL  
,CPF CHAR(14) NOT NULL UNIQUE 
,ENDERECO VARCHAR(400) NOT NULL
,ENDERECO_NUMERO INT NOT NULL
,TELEFONE1 CHAR(14) NOT NULL 
,TELEFONE2 CHAR(14)  
,CIDADE_ID INT NOT NULL 
,DATA_CADASTRO DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP 
,STATUS CHAR(1) NOT NULL DEFAULT 'A' 
,CONSTRAINT PK_FUNCIONARIO PRIMARY KEY (ID) 
,CONSTRAINT FK_FUN_CID FOREIGN KEY (CIDADE_ID) REFERENCES CIDADE (ID)
);

CREATE TABLE CLIENTE(
ID INT AUTO_INCREMENT 
,NOME VARCHAR(255) NOT NULL 
,DOCUMENTO VARCHAR(18) NOT NULL UNIQUE 
,ENDERECO VARCHAR(400) NOT NULL 
,ENDERECO_NUMERO INT NOT NULL
,TELEFONE1 CHAR(14) NOT NULL 
,TELEFONE2 CHAR(14)  
,CONTATO VARCHAR(255)
,CIDADE_ID INT NOT NULL 
,DATA_CADASTRO DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP
,STATUS CHAR(1) NOT NULL DEFAULT 'A' 
,CONSTRAINT PK_CLIENTE PRIMARY KEY (ID) 
,CONSTRAINT FK_CLI_CID FOREIGN KEY (CIDADE_ID) REFERENCES CIDADE (ID)
);

CREATE TABLE FORNECEDOR(
ID INT AUTO_INCREMENT 
,NOME VARCHAR(255) NOT NULL 
,DOCUMENTO VARCHAR(18) NOT NULL UNIQUE 
,ENDERECO VARCHAR(255) NOT NULL 
,ENDERECO_NUMERO INT NOT NULL
,TELEFONE1 VARCHAR(14) NOT NULL 
,TELEFONE2 VARCHAR(14) NOT NULL 
,CONTATO VARCHAR(255) 
,CIDADE_ID INT NOT NULL 
,DATA_CADASTRO DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP
,CONSTRAINT PK_FORNECEDOR PRIMARY KEY (ID) 
,CONSTRAINT FK_FOR_CID FOREIGN KEY (CIDADE_ID) REFERENCES ESTADO (ID)
);

CREATE TABLE PRODUTO_CATEGORIA(
ID INT AUTO_INCREMENT 
,NOME VARCHAR(255) NOT NULL UNIQUE
,DESCRICAO VARCHAR(255) NOT NULL 
,DATA_CADASTRO DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP
,STATUS CHAR(1) NOT NULL DEFAULT 'A' 
,CONSTRAINT PK_CATEGORIA_PRODUTO PRIMARY KEY (ID)
);

CREATE TABLE PRODUTO (
ID INT AUTO_INCREMENT 
,NOME VARCHAR(255) NOT NULL UNIQUE 
,DESCRICAO VARCHAR(255) NOT NULL 
,PRECO_UNITARIO DECIMAL(10,2) NOT NULL 
,ESTOQUE INT NOT NULL 
,STATUS CHAR NOT NULL DEFAULT 'A' 
,DATA_CADASTRO DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP
,CATEGORIA_ID INT NOT NULL 
,CONSTRAINT PK_PRODUTO PRIMARY KEY (ID) 
,CONSTRAINT FK_PROD_CAT FOREIGN KEY (CATEGORIA_ID) REFERENCES PRODUTO_CATEGORIA (ID)
);

CREATE TABLE VENDA (
ID INT AUTO_INCREMENT 
,VALOR DECIMAL(10,2) NOT NULL
,DESCONTO DECIMAL(10,2) NOT NULL DEFAULT 0
,TOTAL DECIMAL(10,2) NOT NULL 
,CLIENTE_ID INT NOT NULL 
,FUNCIONARIO_ID INT NOT NULL 
,DATA_CADASTRO DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP
,STATUS CHAR(1) NOT NULL DEFAULT 'A'
,CONSTRAINT PK_VENDA PRIMARY KEY (ID) 
,CONSTRAINT FK_VENDA_CLIENTE FOREIGN KEY (CLIENTE_ID) REFERENCES CLIENTE (ID) 
,CONSTRAINT FK_VENDA_FUNCIONARIO FOREIGN KEY (FUNCIONARIO_ID) REFERENCES FUNCIONARIO (ID)
);

CREATE TABLE VENDA_ITEM(
VENDA_ID INT NOT NULL 
,PRODUTO_ID INT NOT NULL 
,QUANTIDADE INT NOT NULL  
,PRECO_UNITARIO DECIMAL(10,2) NOT NULL
,VALOR DECIMAL(10,2) NOT NULL
,DESCONTO DECIMAL(10,2) NOT NULL DEFAULT 0
,TOTAL DECIMAL(10,2) NOT NULL
,DATA_CADASTRO DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP
,STATUS CHAR(1) NOT NULL DEFAULT 'A'
,CONSTRAINT PK_VENDA_ITEM PRIMARY KEY (VENDA_ID, PRODUTO_ID) 
,CONSTRAINT FK_ITEMVEN_VENDA FOREIGN KEY (VENDA_ID) REFERENCES VENDA (ID) 
,CONSTRAINT FK_ITEMVEN_PRODUTO FOREIGN KEY (PRODUTO_ID) REFERENCES PRODUTO (ID)
);

CREATE TABLE COMPRA (
ID INT AUTO_INCREMENT 
,VALOR DECIMAL(10,2) NOT NULL
,DESCONTO DECIMAL(10,2) NOT NULL DEFAULT 0
,TOTAL DECIMAL(10,2) NOT NULL 
,FORNECEDOR_ID INT NOT NULL 
,FUNCIONARIO_ID INT NOT NULL 
,DATA_CADASTRO DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP
,STATUS CHAR(1) NOT NULL DEFAULT 'A'
,CONSTRAINT PK_COMPRA PRIMARY KEY (ID) 
,CONSTRAINT FK_COMPRA_FORNECEDOR FOREIGN KEY (FORNECEDOR_ID) REFERENCES FORNECEDOR (ID) 
,CONSTRAINT FK_COMPRA_FUNCIONARIO FOREIGN KEY (FUNCIONARIO_ID) REFERENCES FUNCIONARIO (ID)
);

CREATE TABLE COMPRA_ITEM(
COMPRA_ID INT NOT NULL 
,PRODUTO_ID INT NOT NULL 
,QUANTIDADE INT NOT NULL  
,PRECO_UNITARIO DECIMAL(10,2) NOT NULL
,VALOR DECIMAL(10,2) NOT NULL
,DESCONTO DECIMAL(10,2) NOT NULL DEFAULT 0
,TOTAL DECIMAL(10,2) NOT NULL
,STATUS CHAR(1) NOT NULL DEFAULT 'A'
,DATA_CADASTRO DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP
,CONSTRAINT PK_COMPRA_ITEM PRIMARY KEY (COMPRA_ID, PRODUTO_ID) 
,CONSTRAINT FK_ITEMCOM_COMPRA FOREIGN KEY (COMPRA_ID) REFERENCES COMPRA (ID) 
,CONSTRAINT FK_ITEMCOM_PRODUTO FOREIGN KEY (PRODUTO_ID) REFERENCES PRODUTO (ID)
);

CREATE TABLE CONTA_RECEBER(
ID INT NOT NULL 
,VENDA_ID INT NOT NULL 
,PARCELA_QUANTIDADE INT NOT NULL 
,PARCELA_NUMERO INT NOT NULL 
,VALOR DECIMAL(10,2) NOT NULL
,DESCONTO DECIMAL(10,2) NOT NULL DEFAULT 0
,TOTAL DECIMAL(10,2) NOT NULL
,STATUS CHAR(1) NOT NULL 
,DATA_CADASTRO DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP
,CONSTRAINT PK_CONTA_RECEBER PRIMARY KEY (ID) 
,CONSTRAINT FK_CR_VENDA FOREIGN KEY (VENDA_ID) REFERENCES VENDA (ID) 
);

CREATE TABLE CONTA_PAGAR(
ID INT NOT NULL 
,COMPRA_ID INT NOT NULL 
,PARCELA_QUANTIDADE INT NOT NULL 
,PARCELA_NUMERO INT NOT NULL 
,VALOR DECIMAL(10,2) NOT NULL
,DESCONTO DECIMAL(10,2) NOT NULL DEFAULT 0
,TOTAL DECIMAL(10,2) NOT NULL
,STATUS CHAR(1) NOT NULL 
,DATA_CADASTRO DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP
,CONSTRAINT PK_CONTA_PAGAR PRIMARY KEY (ID) 
,CONSTRAINT FK_CP_COMPRA FOREIGN KEY (COMPRA_ID) REFERENCES COMPRA (ID) 
);

CREATE TABLE CAIXA(
ID INT NOT NULL 
,FUNCIONARIO_ID INT NOT NULL 
,PARCELA_QUANTIDADE INT NOT NULL 
,STATUS CHAR(1) NOT NULL 
,DATA_CADASTRO DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP
,CONSTRAINT PK_CAIXA PRIMARY KEY (ID) 
,CONSTRAINT FK_CAIXA_FUN FOREIGN KEY (FUNCIONARIO_ID) REFERENCES FUNCIONARIO (ID) 
);

CREATE TABLE CAIXA_ITEM(
ID INT NOT NULL 
,CAIXA_ID INT NOT NULL 
,DESCRICAO VARCHAR(255) NOT NULL  
,NATUREZA CHAR(1) NOT NULL  
,VALOR DECIMAL(10,2) NOT NULL 
,STATUS CHAR(1) NOT NULL 
,DATA_CADASTRO DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP
,CONSTRAINT PK_CAIXA_ITEM PRIMARY KEY (ID) 
,CONSTRAINT FK_ITEM_CAIXA FOREIGN KEY (CAIXA_ID) REFERENCES CAIXA (ID) 
);

INSERT INTO estado (nome,sigla) VALUES ('PARANÁ','PR');
INSERT INTO estado (nome,sigla) VALUES ('SÃO PAULO','SP');
INSERT INTO estado (nome,sigla) VALUES ('MATO GROSSO','MT');
INSERT INTO estado (nome,sigla) VALUES ('SANTA CATARINA','SC');
INSERT INTO estado (nome,sigla) VALUES ('RIO GRANDE DO SUL','RS');

INSERT INTO cidade (nome, estado_id) VALUES ('BAURU',2);
INSERT INTO cidade (nome, estado_id) VALUES ('MARINGÁ',1);
INSERT INTO cidade (nome, estado_id) VALUES ('GUARULHOS',2);
INSERT INTO cidade (nome, estado_id) VALUES ('CAMPINAS',2);
INSERT INTO cidade (nome, estado_id) VALUES ('FLORIANÓPOLIS',4);
INSERT INTO cidade (nome, estado_id) VALUES ('PARANAVAÍ',1);
INSERT INTO cidade (nome, estado_id) VALUES ('CUIABA',3);
INSERT INTO cidade (nome, estado_id) VALUES ('BALNEÁRIO CAMBORIÚ',4);
INSERT INTO cidade (nome, estado_id) VALUES ('LONDRINA',1);
INSERT INTO cidade (nome, estado_id) VALUES ('CASCAVEL',1);
INSERT INTO cidade (nome, estado_id) VALUES ('JOINVILLE',4);
INSERT INTO cidade (nome, estado_id) VALUES ('PORTO ALEGRE',5);
INSERT INTO cidade (nome, estado_id) VALUES ('BLUMENAL',4);
INSERT INTO cidade (nome, estado_id) VALUES ('BARRA DOS GARÇAS',3);
INSERT INTO cidade (nome, estado_id) VALUES ('CHAPECÓ',4);
INSERT INTO cidade (nome, estado_id) VALUES ('ITAJAÍ',4);



